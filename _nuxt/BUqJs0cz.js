import{r as g,u as ie,t as A,o as T,_ as de,v as re,m as $e,d as we,b as Q,w as Ue,g as Me,s as ue,e as Se,h as Ve,a as Fe,j as De,p as Oe,x as Te,k as he}from"./D4Yox7jf.js";import{f as N,y as ze,z as ne,A as Re,B as Pe,c,C as Ae,D as Ne,g as O,r as p,h as J,o as d,a as e,d as $,t as y,l as t,b as S,n as ee,j as b,v as z,s as D,k as f,_ as qe,E as je,F as U,m as M,G as Be,i as le,w as te,q as K,u as Ge,H as W,I as Ie,J as Ee,K as He,x as Je}from"./CgYI_Let.js";const We=Symbol.for("nuxt:client-only"),Ke=N({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(w,{slots:k,attrs:C}){const L=ze(!1);ne(()=>{L.value=!0});const x=Ae();return x&&(x._nuxtClientOnly=!0),Ne(We,!0),()=>{if(L.value){const a=k.default?.();return a&&a.length===1?[Re(a[0],C)]:a}const r=k.fallback||k.placeholder;if(r)return Pe(r);const o=w.fallback||w.placeholder||"",n=w.fallbackTag||w.placeholderTag||"span";return c(n,C,o)}}}),Qe=["max"],Xe={class:"row"},Ye={class:"col form-check-label"},Ze={class:"col form-check-label"},el={class:"col form-check-label"},ll=N({__name:"MMemberRow",props:{card:{},openCardDetailsModal:{type:Function}},emits:["update:skillLevel"],setup(w,{emit:k}){const C=w,L=k,x=O(()=>g(C.card)),r=p("optional"),o=ie(x,{level:A[C.card.rarity]||1,centerSkillLevel:10,skillLevel:10,lbCount:1,selected:"optional"});return o.value.level||(o.value.level=A[C.card.rarity]||1),o.value.lbCount||(o.value.lbCount=1),J(r,n=>{o.value.selected=n}),J(O(()=>o.value.skillLevel),n=>{n>10&&(o.value.lbCount=Math.max(o.value.lbCount,n-9))}),J(O(()=>o.value.centerSkillLevel),n=>{n>10&&(o.value.lbCount=Math.max(o.value.lbCount,n-9))}),J(o,n=>{L("update:skillLevel",n)}),ne(()=>{r.value=o.value.selected||"optional",L("update:skillLevel",o.value)}),(n,a)=>{const u=de;return d(),c("tr",null,[e("td",null,[$(y(t(T)(n.card))+" ",1),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:a[0]||(a[0]=v=>n.openCardDetailsModal(n.card))},[S(u,{icon:"circle-info"})])]),e("td",{class:ee({"gained-ap":t(re)(n.card,t(o).level)>0})},y(n.card.ap+t(re)(n.card,t(o).level)),3),e("td",null,[b(e("input",{"onUpdate:modelValue":a[1]||(a[1]=v=>t(o).level=v),class:ee(["form-control",{"not-max":t(o).level!==t(A)[n.card.rarity]}]),type:"number",min:"1",max:t(A)[n.card.rarity],onChange:a[2]||(a[2]=v=>L("update:skillLevel",t(o)))},null,42,Qe),[[z,t(o).level,void 0,{number:!0}]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":a[3]||(a[3]=v=>t(o).skillLevel=v),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[z,t(o).skillLevel,void 0,{number:!0}]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":a[4]||(a[4]=v=>t(o).centerSkillLevel=v),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[z,t(o).centerSkillLevel,void 0,{number:!0}]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":a[5]||(a[5]=v=>t(o).lbCount=v),class:"form-control",type:"number",min:"0",max:"5"},null,512),[[z,t(o).lbCount,void 0,{number:!0}]])]),e("td",{class:ee({"required-bg":t(r)==="required","excluded-bg":t(r)==="excluded"})},[e("div",Xe,[e("label",Ye,[b(e("input",{"onUpdate:modelValue":a[6]||(a[6]=v=>f(r)?r.value=v:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[D,t(r)]]),a[9]||(a[9]=$(" 必須 ",-1))]),e("label",Ze,[b(e("input",{"onUpdate:modelValue":a[7]||(a[7]=v=>f(r)?r.value=v:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[D,t(r)]]),a[10]||(a[10]=$(" 任意 ",-1))]),e("label",el,[b(e("input",{"onUpdate:modelValue":a[8]||(a[8]=v=>f(r)?r.value=v:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[D,t(r)]]),a[11]||(a[11]=$(" 除外 ",-1))])])],2)])}}}),tl=Object.assign(qe(ll,[["__scopeId","data-v-5d9f6f60"]]),{__name:"MMemberRow"}),nl={class:"card my-2"},sl={class:"card-body"},ol={class:"row"},al={class:"input-group"},rl={class:"input-group-prepend"},ul={class:"input-group-text",style:{width:"74px","justify-content":"center"}},il=["onUpdate:modelValue"],dl=N({__name:"OSeasonFanLv",props:{seasonFanLvs:{required:!0},seasonFanLvsModifiers:{}},emits:["update:seasonFanLvs"],setup(w){const k=je(w,"seasonFanLvs"),C=["kaho","sayaka","rurino","ginko","kosuzu","hime","ceras","izumi"];return(L,x)=>(d(),c("div",nl,[x[0]||(x[0]=e("div",{class:"card-header"}," Season Fan Lv. ",-1)),e("div",sl,[e("div",ol,[(d(),c(U,null,M(C,r=>e("div",{key:r,class:"col-12 col-sm-6 col-md-4 col-lg-3 mb-2"},[e("div",al,[e("div",rl,[e("div",ul,[e("span",null,y(t($e)[r]),1)])]),b(e("input",{"onUpdate:modelValue":o=>k.value[r]=o,type:"number",class:"form-control",min:"1",max:"10"},null,8,il),[[z,k.value[r],void 0,{number:!0}]])])])),64))])])]))}}),vl=Object.assign(dl,{__name:"OSeasonFanLv"}),cl={class:"mb-3"},pl={class:"my-2"},ml={class:"card my-2"},fl={class:"card-body"},yl={class:"table"},bl={class:"card my-2"},kl={class:"card-body"},gl={class:"table"},Cl={key:0,rowspan:"14"},_l={class:"card my-2"},Ll={class:"card-body"},xl={class:"table"},$l={class:"card my-2"},wl={class:"card-body"},Ul=N({__name:"MdCardDetails",props:{onClose:{},card:{},displayLevel:{}},setup(w){const k=w,C=O(()=>Array.from({length:14},(o,n)=>we(Q(k.card,n+1,n+1)))),L=Be(new Set([...Ue[k.card.rarity].map(([o])=>o),k.displayLevel])),x=O(()=>Array.from(L).sort((o,n)=>o-n)),r=O(()=>x.value.map(o=>Q(k.card,1,1,o)));return(o,n)=>{const a=Ve;return d(),le(a,{"on-close":o.onClose},{default:te(()=>[e("h3",cl,y(t(T)(o.card)),1),e("div",pl,[e("div",ml,[n[6]||(n[6]=e("div",{class:"card-header"}," ステータス ",-1)),e("div",fl,[e("table",yl,[e("thead",null,[e("tr",null,[n[1]||(n[1]=e("th",null,"ステータス",-1)),(d(!0),c(U,null,M(t(x),u=>(d(),c("th",{key:`status-${u}`}," Lv."+y(u),1))),128))])]),e("tbody",null,[e("tr",null,[n[2]||(n[2]=e("td",null,"スマイル",-1)),(d(!0),c(U,null,M(t(r),u=>(d(),c("td",{key:`status-smile-${u.key}`},y(u.smile),1))),128))]),e("tr",null,[n[3]||(n[3]=e("td",null,"ピュア",-1)),(d(!0),c(U,null,M(t(r),u=>(d(),c("td",{key:`status-pure-${u.key}`},y(u.pure),1))),128))]),e("tr",null,[n[4]||(n[4]=e("td",null,"クール",-1)),(d(!0),c(U,null,M(t(r),u=>(d(),c("td",{key:`status-cool-${u.key}`},y(u.cool),1))),128))]),e("tr",null,[n[5]||(n[5]=e("td",null,"メンタル",-1)),(d(!0),c(U,null,M(t(r),u=>(d(),c("td",{key:`status-mental-${u.key}`},y(u.mental),1))),128))])])])])]),e("div",bl,[n[8]||(n[8]=e("div",{class:"card-header"}," センタースキル ",-1)),e("div",kl,[e("table",gl,[n[7]||(n[7]=e("thead",null,[e("tr",null,[e("th",null,"スキルLv."),e("th",null,"発動条件"),e("th",null,"効果")])],-1)),e("tbody",null,[(d(!0),c(U,null,M(t(C),(u,v)=>(d(),c("tr",{key:`center-skill-${v}`},[e("td",null,y(v+1),1),v===0?(d(),c("td",Cl,y(t(Me)(u.centerSkillCondition)),1)):K("",!0),e("td",null,y(t(ue)(u.centerSkills)),1)]))),128))])])])]),e("div",_l,[n[10]||(n[10]=e("div",{class:"card-header"}," スキル ",-1)),e("div",Ll,[e("table",xl,[n[9]||(n[9]=e("thead",null,[e("tr",null,[e("th",null,"スキルLv."),e("th",null,"効果")])],-1)),e("tbody",null,[(d(!0),c(U,null,M(t(C),(u,v)=>(d(),c("tr",{key:`skill-${v}`},[e("td",null,y(v+1),1),e("td",null,y(t(ue)(u.skills)),1)]))),128))])])])]),e("div",$l,[n[11]||(n[11]=e("div",{class:"card-header"}," センター特性 ",-1)),e("div",wl,y(t(Se)(t(C)[0].centerAbilities)),1)]),e("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=u=>o.onClose(null))}," 閉じる ")])]),_:1},8,["on-close"])}}}),Ml=Object.assign(Ul,{__name:"MdCardDetails"}),Sl={class:"container-md"},Vl={class:"card my-2"},Fl={class:"card-body"},Dl={class:"table"},Ol={scope:"col"},Tl={class:"d-flex align-items-end"},hl={class:""},zl={class:"input-group"},Rl={class:"input-group-prepend"},Pl={class:"input-group-text"},Al={style:{"min-height":"1.5em"}},Nl={style:{"text-align":"right"}},ql={class:"card my-2"},jl={class:"card-body"},Bl={class:"mb-2"},Gl={class:"row"},Il={class:"col-auto"},El={class:"col-auto"},Hl={class:"mb-2"},Jl={class:"row"},Wl={class:"col-auto"},Kl={class:"col-auto"},Ql={class:"mb-2"},Xl={class:"row"},Yl={class:"col-auto"},Zl={class:"col-auto"},et={class:"mb-2"},lt={class:"form-check"},tt={class:"form-check"},nt={class:"form-check"},st={class:"form-check"},ot={key:2},at={class:"card my-2"},rt={class:"card-body"},ut=["value"],vt=N({__name:"auto-formation",setup(w){const k=p(""),C=p(""),L=p(0),x=p(0),r=p("smile"),o=p(50),n=p("perfect"),a=p("current"),u=p("score"),v=p([]),q=ie("seasonFanLvs",{kaho:1,sayaka:1,rurino:1,ginko:1,kosuzu:1,hime:1,ceras:1,izumi:1,kozue:1,tsuzuri:1,megumi:1}),j=p(""),B=p(!0),G=p(!0),I=p(!0),E=p(!0),V=p([...Fe]),_=p(Object.fromEntries(V.value.map(i=>[g(i),{level:A[i.rarity]||1,centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),ve=(i,l)=>{_.value[i]=l},ce=O(()=>V.value.filter(i=>_.value[g(i)]?.selected==="required").length),pe=O(()=>V.value.filter(i=>_.value[g(i)]?.selected==="excluded").length),me=O(()=>V.value.filter(i=>_.value[g(i)]?.selected==="optional").length),H=p(null),F=p(null),X=p(0),se=p(Promise.resolve()),h=p("finished"),oe=()=>{H.value=new Worker(new URL(""+new URL("calc-worker-COcxHf6V.js",import.meta.url).href,import.meta.url),{type:"module"}),H.value.onmessage=i=>{switch(i.data.message){case"calcScore":se.value=se.value.then(async()=>{i.data.data.score>(F.value?.score||0)&&(F.value={score:i.data.data.score,liveGrandPrixPt:i.data.data.liveGrandPrixPt,members:i.data.data.members,centerMember:i.data.data.centerMember,log:i.data.data.log})});break;case"progress":X.value=i.data.data.progress;break;case"end":h.value="finished";break}}};ne(()=>{oe()});const fe=()=>{F.value=null,X.value=0;const i=Oe(k.value,L.value),l=V.value.filter(m=>_.value[g(m)]&&_.value[g(m)].selected==="required").map(m=>Q(m,_.value[g(m)]?.skillLevel||10,_.value[g(m)]?.centerSkillLevel||10,_.value[g(m)]?.level||1));if(l.length>6){R("必要メンバーが6人を超えています");return}const P=V.value.filter(m=>!_.value[g(m)]?.selected||_.value[g(m)].selected==="optional").map(m=>Q(m,_.value[g(m)]?.skillLevel||10,_.value[g(m)]?.centerSkillLevel||10,_.value[g(m)]?.level||1));h.value="running",H.value?.postMessage(JSON.parse(JSON.stringify({requiredMembers:l,optionalMembers:P,notes:i,center:C.value,attribute:r.value,masteryLevel:o.value,playStyle:n.value,formationRule:a.value,includingCenterOnly:B.value,noLog:G.value,noDamagedFormation:I.value,noCuredFormation:E.value,scoreComparisonRule:u.value,seasonFanLvs:q.value,singers:v.value})))},ye=()=>{H.value?.terminate(),oe(),h.value="finished"},R=i=>{window.alert(i)},{modals:be,openModal:ke}=De(),ge=async i=>{await ke(Ml,{card:i,displayLevel:_.value[g(i)]?.level||1})},Y=p(null),Ce=()=>{const i=Y.value?.files?.[0];if(i){const l=new FileReader;l.onload=P=>{const m=P.target?.result;V.value=V.value.concat(Te(m))},l.readAsText(i)}},_e=p(null);return Ge({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(i,l)=>{const P=he,m=de,Le=tl,ae=Ke,xe=vl;return d(),c("div",Sl,[l[48]||(l[48]=e("h1",null,"スクショウ自動編成",-1)),S(P,{"note-text":t(k),"onUpdate:noteText":l[0]||(l[0]=s=>f(k)?k.value=s:null),center:t(C),"onUpdate:center":l[1]||(l[1]=s=>f(C)?C.value=s:null),offset:t(L),"onUpdate:offset":l[2]||(l[2]=s=>f(L)?L.value=s:null),"combo-offset":t(x),"onUpdate:comboOffset":l[3]||(l[3]=s=>f(x)?x.value=s:null),attribute:t(r),"onUpdate:attribute":l[4]||(l[4]=s=>f(r)?r.value=s:null),"mastery-level":t(o),"onUpdate:masteryLevel":l[5]||(l[5]=s=>f(o)?o.value=s:null),singers:t(v),"onUpdate:singers":l[6]||(l[6]=s=>f(v)?v.value=s:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level","singers"]),e("div",Vl,[l[31]||(l[31]=e("div",{class:"card-header"}," メンバー ",-1)),e("div",Fl,[e("table",Dl,[e("thead",null,[e("tr",null,[e("th",Ol,[e("div",Tl,[l[24]||(l[24]=e("div",{style:{"margin-right":"8px"}}," カード ",-1)),e("div",hl,[e("div",zl,[e("div",Rl,[e("div",Pl,[e("div",Al,[S(m,{icon:["fas","magnifying-glass"]})])])]),b(e("input",{"onUpdate:modelValue":l[7]||(l[7]=s=>f(j)?j.value=s:null),type:"text",class:"form-control"},null,512),[[z,t(j)]])])])])]),l[25]||(l[25]=e("th",{scope:"col"},"AP",-1)),l[26]||(l[26]=e("th",{scope:"col"},"Lv.",-1)),l[27]||(l[27]=e("th",{scope:"col"},"スキルLv.",-1)),l[28]||(l[28]=e("th",{scope:"col"},"センターSLv.",-1)),l[29]||(l[29]=e("th",{scope:"col"},"凸数",-1)),l[30]||(l[30]=e("th",{scope:"col"},"選択",-1))])]),e("tbody",null,[S(ae,null,{default:te(()=>[(d(!0),c(U,null,M(t(V),s=>b((d(),le(Le,{key:t(T)(s),card:s,"open-card-details-modal":ge,"onUpdate:skillLevel":Z=>ve(t(g)(s),Z)},null,8,["card","onUpdate:skillLevel"])),[[Ie,t(T)(s).toLowerCase().includes(t(j).toLowerCase())]])),128))]),_:1})])]),e("div",Nl," 必須："+y(t(ce))+" 任意："+y(t(me))+" 除外："+y(t(pe)),1),e("button",{type:"button",class:"btn btn-primary",onClick:l[8]||(l[8]=s=>t(Y)?.click())}," TSVインポート "),e("input",{ref_key:"tsvFileInput",ref:Y,type:"file",class:"d-none",onChange:Ce},null,544)])]),S(ae,null,{default:te(()=>[S(xe,{"season-fan-lvs":t(q),"onUpdate:seasonFanLvs":l[9]||(l[9]=s=>f(q)?q.value=s:null)},null,8,["season-fan-lvs"])]),_:1}),e("div",ql,[l[47]||(l[47]=e("div",{class:"card-header"}," 計算 ",-1)),e("div",jl,[e("div",Bl,[l[34]||(l[34]=$(" プレイスタイル： ",-1)),e("div",Gl,[e("div",Il,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[10]||(l[10]=s=>f(n)?n.value=s:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[D,t(n)]]),l[32]||(l[32]=$(" 渾身 ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[11]||(l[11]=s=>R("メンタルを100%以上に保つプレイ"))},[S(m,{icon:"circle-info"})])]),e("div",El,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[12]||(l[12]=s=>f(n)?n.value=s:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[D,t(n)]]),l[33]||(l[33]=$(" 背水 ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[13]||(l[13]=s=>R("メンタルを10%以下に保つプレイ"))},[S(m,{icon:"circle-info"})])])])]),e("div",Hl,[l[37]||(l[37]=$(" 編成ルール ",-1)),e("div",Jl,[e("div",Wl,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[14]||(l[14]=s=>f(a)?a.value=s:null),class:"form-check-input",type:"radio",value:"current"},null,512),[[D,t(a)]]),l[35]||(l[35]=$(" 現状のルール ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[15]||(l[15]=s=>R(`・メンバー1人あたり1種類まで
・カード制限なし`))},[S(m,{icon:"circle-info"})])]),e("div",Kl,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[16]||(l[16]=s=>f(a)?a.value=s:null),class:"form-check-input",type:"radio",value:"new_grand_prix"},null,512),[[D,t(a)]]),l[36]||(l[36]=$(" 新ライグラルール ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[17]||(l[17]=s=>R(`・メンバー1人あたり2種類まで
・DRは1枚まで`))},[S(m,{icon:"circle-info"})])])])]),e("div",Ql,[l[40]||(l[40]=$(" スコア比較基準 ",-1)),e("div",Xl,[e("div",Yl,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[18]||(l[18]=s=>f(u)?u.value=s:null),class:"form-check-input",type:"radio",value:"score"},null,512),[[D,t(u)]]),l[38]||(l[38]=$(" スコア ",-1))])]),e("div",Zl,[e("label",null,[b(e("input",{"onUpdate:modelValue":l[19]||(l[19]=s=>f(u)?u.value=s:null),class:"form-check-input",type:"radio",value:"grandPrixPt"},null,512),[[D,t(u)]]),l[39]||(l[39]=$(" グランプリpt ",-1))])])])]),e("div",et,[l[45]||(l[45]=$(" オプション： ",-1)),e("div",lt,[b(e("input",{id:"includingCenterOnly","onUpdate:modelValue":l[20]||(l[20]=s=>f(B)?B.value=s:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(B)]]),l[41]||(l[41]=e("label",{class:"form-check-label",for:"includingCenterOnly"}," センターのメンバーを含まない編成は計算しない ",-1))]),e("div",tt,[b(e("input",{id:"noLog","onUpdate:modelValue":l[21]||(l[21]=s=>f(G)?G.value=s:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(G)]]),l[42]||(l[42]=e("label",{class:"form-check-label",for:"noLog"}," ログを出力しない（効果大） ",-1))]),e("div",nt,[b(e("input",{id:"noDamagedFormation","onUpdate:modelValue":l[22]||(l[22]=s=>f(I)?I.value=s:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(I)]]),l[43]||(l[43]=e("label",{class:"form-check-label",for:"noDamagedFormation"}," 途中でメンタルが100%未満になった場合計算を打ち切る（渾身選択時以外は自動で無効） ",-1))]),e("div",st,[b(e("input",{id:"noCuredFormation","onUpdate:modelValue":l[23]||(l[23]=s=>f(E)?E.value=s:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(E)]]),l[44]||(l[44]=e("label",{class:"form-check-label",for:"noCuredFormation"}," 途中でメンタルが10%超になった場合計算を打ち切る（背水選択時以外は自動で無効） ",-1))])]),t(h)!=="running"?(d(),c("button",{key:0,type:"button",class:"btn btn-primary",onClick:fe}," 計算 ")):K("",!0),t(h)==="running"?(d(),c("button",{key:1,type:"button",class:"btn btn-primary",onClick:ye}," 中止 ")):K("",!0),t(F)?(d(),c("div",ot,[e("p",{ref_key:"progressView",ref:_e},y(t(h)==="running"?`計算中... ${t(X).toFixed(2)}%`:"計算完了"),513),e("div",at,[e("div",rt,[e("p",null,"最高得点: "+y(t(F).score)+" ("+y(t(F).liveGrandPrixPt)+"pt)",1),l[46]||(l[46]=e("p",null,"メンバー:",-1)),e("ul",null,[(d(!0),c(U,null,M(t(F).members,s=>(d(),c("li",{key:t(g)(s),style:Ee({fontWeight:t(T)(s)===t(T)(t(F).centerMember)?"bold":"normal"})},y(t(T)(s)),5))),128))]),e("textarea",{class:"form-control",value:t(F).log,readonly:"",rows:"5"},null,8,ut)])])])):K("",!0)])]),(d(!0),c(U,null,M(t(be),(s,Z)=>(d(),le(Je(s.component),He({key:`modal-${Z}`,"on-close":s.onClose},{ref_for:!0},s.args),null,16,["on-close"]))),128))])}}});export{vt as default};
