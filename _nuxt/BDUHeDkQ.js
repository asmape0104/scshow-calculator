import{n as m,u as W,o as h,a as S,p as A,b as T,_ as F}from"./1Z4YnXQK.js";import{d as z,k as J,r,H as $,o as D,y as b,z as p,A as e,B as M,M as t,J as f,L as j,E as L,S as w,K as v,x as G,C as Q,N as q,O as E,R as O,U as X,I as Y}from"./Cbqrjwks.js";const Z={class:"row"},ee={class:"col form-check-label"},le={class:"col form-check-label"},te={class:"col form-check-label"},oe=z({__name:"MMemberRow",props:{card:{}},emits:["update:skillLevel"],setup(N,{emit:g}){const U=N,k=g,_=J(()=>m(U.card)),a=r("optional"),i=W(_,{centerSkillLevel:10,skillLevel:10,selected:"optional"});return $(a,d=>{i.value.selected=d}),$(i,d=>{k("update:skillLevel",d)}),D(()=>{a.value=i.value.selected||"optional",k("update:skillLevel",i.value)}),(d,s)=>(p(),b("tr",null,[e("td",null,M(t(h)(d.card)),1),e("td",null,[f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(i).skillLevel=n),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[j,t(i).skillLevel,void 0,{number:!0}]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t(i).centerSkillLevel=n),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[j,t(i).centerSkillLevel,void 0,{number:!0}]])]),e("td",null,[e("div",Z,[e("label",ee,[f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>v(a)?a.value=n:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[w,t(a)]]),s[5]||(s[5]=L(" 必須 "))]),e("label",le,[f(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>v(a)?a.value=n:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[w,t(a)]]),s[6]||(s[6]=L(" 任意 "))]),e("label",te,[f(e("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>v(a)?a.value=n:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[w,t(a)]]),s[7]||(s[7]=L(" 除外 "))])])])]))}}),se=Object.assign(oe,{__name:"MMemberRow"}),ne={class:"container-md"},ae={class:"card my-2"},ue={class:"card-body"},re={class:"table"},ie={class:"card my-2"},de={class:"card-body"},ce={class:"mb-2"},me={class:"row"},ve={class:"col-auto"},pe={class:"col-auto"},be={class:"mb-2"},fe={class:"form-check"},ke={key:2},ye={class:"card my-2"},Le={class:"card-body"},ge=["value"],_e=z({__name:"auto-formation",setup(N){const g=r(""),U=r(""),k=r(0),_=r(0),a=r("smile"),i=r(50),d=r("perfect"),s=r(!0),n=r(Object.fromEntries(S.map(c=>[m(c),{centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),H=(c,l)=>{n.value[c]=l},C=r(null),y=r(null),R=r(Promise.resolve()),x=r("finished"),B=()=>{C.value=new Worker(new URL(""+new URL("calc-worker-Bhi3Ibwz.js",import.meta.url).href,import.meta.url),{type:"module"}),C.value.onmessage=c=>{switch(c.data.message){case"calcScore":R.value=R.value.then(async()=>{c.data.data.score>(y.value?.score||0)&&(y.value={score:c.data.data.score,members:c.data.data.members,log:c.data.data.log})});break;case"end":x.value="finished";break}}};D(()=>{B()});const I=()=>{y.value=null;const c=A(g.value,k.value),l=S.filter(u=>n.value[m(u)]&&n.value[m(u)].selected==="required").map(u=>T(u,n.value[m(u)]?.skillLevel||10,n.value[m(u)]?.centerSkillLevel||10));if(l.length>6){alert("必要メンバーが6人を超えています");return}const V=S.filter(u=>!n.value[m(u)]?.selected||n.value[m(u)].selected==="optional").map(u=>T(u,n.value[m(u)]?.skillLevel||10,n.value[m(u)]?.centerSkillLevel||10));x.value="running",C.value?.postMessage({requiredMembers:l,optionalMembers:V,notes:c,center:U.value,attribute:a.value,masteryLevel:i.value,playStyle:d.value,includingCenterOnly:s.value})},K=()=>{C.value?.terminate(),B(),x.value="finished"};return G({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(c,l)=>{const V=F,u=se;return p(),b("div",ne,[l[18]||(l[18]=e("h1",null,"スクショウ自動編成",-1)),Q(V,{"note-text":t(g),"onUpdate:noteText":l[0]||(l[0]=o=>v(g)?g.value=o:null),center:t(U),"onUpdate:center":l[1]||(l[1]=o=>v(U)?U.value=o:null),offset:t(k),"onUpdate:offset":l[2]||(l[2]=o=>v(k)?k.value=o:null),"combo-offset":t(_),"onUpdate:comboOffset":l[3]||(l[3]=o=>v(_)?_.value=o:null),attribute:t(a),"onUpdate:attribute":l[4]||(l[4]=o=>v(a)?a.value=o:null),"mastery-level":t(i),"onUpdate:masteryLevel":l[5]||(l[5]=o=>v(i)?i.value=o:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level"]),e("div",ae,[l[10]||(l[10]=e("div",{class:"card-header"}," メンバー ",-1)),e("div",ue,[e("table",re,[l[9]||(l[9]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"カード"),e("th",{scope:"col"},"スキルLv."),e("th",{scope:"col"},"センタースキルLv."),e("th",{scope:"col"},"選択")])],-1)),e("tbody",null,[(p(!0),b(q,null,E(t(S),o=>(p(),Y(u,{key:o.key,card:o,"onUpdate:skillLevel":P=>H(t(m)(o),P)},null,8,["card","onUpdate:skillLevel"]))),128))])])])]),e("div",ie,[l[17]||(l[17]=e("div",{class:"card-header"}," 計算 ",-1)),e("div",de,[e("div",ce,[l[13]||(l[13]=L(" プレイスタイル： ")),e("div",me,[e("div",ve,[e("label",null,[f(e("input",{"onUpdate:modelValue":l[6]||(l[6]=o=>v(d)?d.value=o:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[w,t(d)]]),l[11]||(l[11]=L(" 渾身 "))])]),e("div",pe,[e("label",null,[f(e("input",{"onUpdate:modelValue":l[7]||(l[7]=o=>v(d)?d.value=o:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[w,t(d)]]),l[12]||(l[12]=L(" 背水 "))])])])]),e("div",be,[l[15]||(l[15]=L(" オプション： ")),e("div",fe,[f(e("input",{id:"includingCenterOnly","onUpdate:modelValue":l[8]||(l[8]=o=>v(s)?s.value=o:null),class:"form-check-input",type:"checkbox"},null,512),[[X,t(s)]]),l[14]||(l[14]=e("label",{class:"form-check-label",for:"includingCenterOnly"}," センターのメンバーを含まない編成は計算しない ",-1))])]),t(x)!=="running"?(p(),b("button",{key:0,type:"button",class:"btn btn-primary",onClick:I}," 計算 ")):O("",!0),t(x)==="running"?(p(),b("button",{key:1,type:"button",class:"btn btn-primary",onClick:K}," 中止 ")):O("",!0),t(y)?(p(),b("div",ke,[e("p",null,M(t(x)==="running"?"計算中...":"計算完了"),1),e("div",ye,[e("div",Le,[e("p",null,"最高得点: "+M(t(y).score),1),l[16]||(l[16]=e("p",null,"メンバー:",-1)),e("ul",null,[(p(!0),b(q,null,E(t(y).members,o=>(p(),b("li",{key:t(m)(o)},M(t(h)(o)),1))),128))]),e("textarea",{class:"form-control",value:t(y).log,readonly:"",rows:"5"},null,8,ge)])])])):O("",!0)])])])}}});export{_e as default};
