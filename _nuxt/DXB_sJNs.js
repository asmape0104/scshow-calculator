import{n as m,u as z,o as W,a as M,p as A,b as T,_ as F}from"./DqdEsHwg.js";import{d as D,k as I,r as i,H as $,o as H,y as b,z as p,A as e,B as V,M as t,J as y,L as j,E as U,S as w,K as v,x as X,C as h,N as q,O as E,R as N,I as G}from"./Fa-MyB08.js";const Q={class:"row"},Y={class:"col form-check-label"},Z={class:"col form-check-label"},ee={class:"col form-check-label"},le=D({__name:"MMemberRow",props:{card:{}},emits:["update:skillLevel"],setup(R,{emit:L}){const _=R,f=L,x=I(()=>m(_.card)),n=i("optional"),u=z(x,{centerSkillLevel:10,skillLevel:10,selected:"optional"});return $(n,r=>{u.value.selected=r}),$(u,r=>{f("update:skillLevel",r)}),H(()=>{n.value=u.value.selected||"optional",f("update:skillLevel",u.value)}),(r,o)=>(p(),b("tr",null,[e("td",null,V(t(W)(r.card)),1),e("td",null,[y(e("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>t(u).skillLevel=c),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[j,t(u).skillLevel,void 0,{number:!0}]])]),e("td",null,[y(e("input",{"onUpdate:modelValue":o[1]||(o[1]=c=>t(u).centerSkillLevel=c),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[j,t(u).centerSkillLevel,void 0,{number:!0}]])]),e("td",null,[e("div",Q,[e("label",Y,[y(e("input",{"onUpdate:modelValue":o[2]||(o[2]=c=>v(n)?n.value=c:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[w,t(n)]]),o[5]||(o[5]=U(" 必須 "))]),e("label",Z,[y(e("input",{"onUpdate:modelValue":o[3]||(o[3]=c=>v(n)?n.value=c:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[w,t(n)]]),o[6]||(o[6]=U(" 任意 "))]),e("label",ee,[y(e("input",{"onUpdate:modelValue":o[4]||(o[4]=c=>v(n)?n.value=c:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[w,t(n)]]),o[7]||(o[7]=U(" 除外 "))])])])]))}}),te=Object.assign(le,{__name:"MMemberRow"}),oe={class:"container-md"},se={class:"card my-2"},ne={class:"card-body"},ae={class:"table"},ue={class:"card my-2"},re={class:"card-body"},ie={class:"mb-2"},de={class:"row"},me={class:"col-auto"},ce={class:"col-auto"},ve={key:2},pe={class:"card my-2"},be={class:"card-body"},fe=["value"],Le=D({__name:"auto-formation",setup(R){const L=i(""),_=i(""),f=i(0),x=i(0),n=i("smile"),u=i(50),r=i("perfect"),o=i(Object.fromEntries(M.map(d=>[m(d),{centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),c=(d,l)=>{o.value[d]=l},S=i(null),k=i(null),B=i(Promise.resolve()),g=i("finished"),O=()=>{S.value=new Worker(new URL(""+new URL("calc-worker-B8WdJX-a.js",import.meta.url).href,import.meta.url),{type:"module"}),S.value.onmessage=d=>{switch(d.data.message){case"calcScore":B.value=B.value.then(async()=>{d.data.data.score>(k.value?.score||0)&&(k.value={score:d.data.data.score,members:d.data.data.members,log:d.data.data.log})});break;case"end":g.value="finished";break}}};H(()=>{O()});const J=()=>{k.value=null;const d=A(L.value,f.value),l=M.filter(a=>o.value[m(a)]&&o.value[m(a)].selected==="required").map(a=>T(a,o.value[m(a)]?.skillLevel||10,o.value[m(a)]?.centerSkillLevel||10));if(l.length>6){alert("必要メンバーが6人を超えています");return}const C=M.filter(a=>!o.value[m(a)]?.selected||o.value[m(a)].selected==="optional").map(a=>T(a,o.value[m(a)]?.skillLevel||10,o.value[m(a)]?.centerSkillLevel||10));g.value="running",S.value?.postMessage({requiredMembers:l,optionalMembers:C,notes:d,center:_.value,attribute:n.value,masteryLevel:u.value,playStyle:r.value})},K=()=>{S.value?.terminate(),O(),g.value="finished"};return X({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(d,l)=>{const C=F,a=te;return p(),b("div",oe,[l[15]||(l[15]=e("h1",null,"スクショウ自動編成",-1)),h(C,{"note-text":t(L),"onUpdate:noteText":l[0]||(l[0]=s=>v(L)?L.value=s:null),center:t(_),"onUpdate:center":l[1]||(l[1]=s=>v(_)?_.value=s:null),offset:t(f),"onUpdate:offset":l[2]||(l[2]=s=>v(f)?f.value=s:null),"combo-offset":t(x),"onUpdate:comboOffset":l[3]||(l[3]=s=>v(x)?x.value=s:null),attribute:t(n),"onUpdate:attribute":l[4]||(l[4]=s=>v(n)?n.value=s:null),"mastery-level":t(u),"onUpdate:masteryLevel":l[5]||(l[5]=s=>v(u)?u.value=s:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level"]),e("div",se,[l[9]||(l[9]=e("div",{class:"card-header"}," メンバー ",-1)),e("div",ne,[e("table",ae,[l[8]||(l[8]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"カード"),e("th",{scope:"col"},"スキルLv."),e("th",{scope:"col"},"センタースキルLv."),e("th",{scope:"col"},"選択")])],-1)),e("tbody",null,[(p(!0),b(q,null,E(t(M),s=>(p(),G(a,{key:s.key,card:s,"onUpdate:skillLevel":P=>c(t(m)(s),P)},null,8,["card","onUpdate:skillLevel"]))),128))])])])]),e("div",ue,[l[14]||(l[14]=e("div",{class:"card-header"}," 計算 ",-1)),e("div",re,[e("div",ie,[l[12]||(l[12]=U(" プレイスタイル： ")),e("div",de,[e("div",me,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[6]||(l[6]=s=>v(r)?r.value=s:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[w,t(r)]]),l[10]||(l[10]=U(" 渾身 "))])]),e("div",ce,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[7]||(l[7]=s=>v(r)?r.value=s:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[w,t(r)]]),l[11]||(l[11]=U(" 背水 "))])])])]),t(g)!=="running"?(p(),b("button",{key:0,type:"button",class:"btn btn-primary",onClick:J}," 計算 ")):N("",!0),t(g)==="running"?(p(),b("button",{key:1,type:"button",class:"btn btn-primary",onClick:K}," 中止 ")):N("",!0),t(k)?(p(),b("div",ve,[e("p",null,V(t(g)==="running"?"計算中...":"計算完了"),1),e("div",pe,[e("div",be,[e("p",null,"最高得点: "+V(t(k).score),1),l[13]||(l[13]=e("p",null,"メンバー:",-1)),e("ul",null,[(p(!0),b(q,null,E(t(k).members,s=>(p(),b("li",{key:t(m)(s)},V(t(W)(s)),1))),128))]),e("textarea",{class:"form-control",value:t(k).log,readonly:"",rows:"5"},null,8,fe)])])])):N("",!0)])])])}}});export{Le as default};
