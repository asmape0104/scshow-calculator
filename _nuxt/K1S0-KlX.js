import{r as C,u as ie,t as A,o as D,_ as de,v as ae,m as Le,d as _e,b as Q,w as $e,g as xe,s as re,e as we,h as Ue,a as Me,j as Se,p as Ve,x as Fe,k as De}from"./BM_wIlxx.js";import{f as N,y as Oe,z as te,A as Te,B as ze,c as v,C as Re,D as he,g as R,r as p,h as J,o as i,a as e,d as $,t as b,l as t,b as S,n as ue,j as y,v as z,s as F,k as f,_ as Pe,E as Ae,F as U,m as M,G as Ne,i as ee,w as le,q as K,u as je,H as W,I as Be,J as qe,K as Ge,x as Ie}from"./B8u8UqNb.js";const Ee=Symbol.for("nuxt:client-only"),He=N({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(w,{slots:k,attrs:g}){const L=Oe(!1);te(()=>{L.value=!0});const _=Re();return _&&(_._nuxtClientOnly=!0),he(Ee,!0),()=>{if(L.value){const a=k.default?.();return a&&a.length===1?[Te(a[0],g)]:a}const u=k.fallback||k.placeholder;if(u)return ze(u);const o=w.fallback||w.placeholder||"",s=w.fallbackTag||w.placeholderTag||"span";return v(s,g,o)}}}),Je=["max"],We={class:"row"},Ke={class:"col form-check-label"},Qe={class:"col form-check-label"},Xe={class:"col form-check-label"},Ye=N({__name:"MMemberRow",props:{card:{},openCardDetailsModal:{type:Function}},emits:["update:skillLevel"],setup(w,{emit:k}){const g=w,L=k,_=R(()=>C(g.card)),u=p("optional"),o=ie(_,{level:A[g.card.rarity]||1,centerSkillLevel:10,skillLevel:10,lbCount:1,selected:"optional"});return o.value.level||(o.value.level=A[g.card.rarity]||1),o.value.lbCount||(o.value.lbCount=1),J(u,s=>{o.value.selected=s}),J(R(()=>o.value.skillLevel),s=>{s>10&&(o.value.lbCount=Math.max(o.value.lbCount,s-9))}),J(R(()=>o.value.centerSkillLevel),s=>{s>10&&(o.value.lbCount=Math.max(o.value.lbCount,s-9))}),J(o,s=>{L("update:skillLevel",s)}),te(()=>{u.value=o.value.selected||"optional",L("update:skillLevel",o.value)}),(s,a)=>{const r=de;return i(),v("tr",null,[e("td",null,[$(b(t(D)(s.card))+" ",1),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:a[0]||(a[0]=d=>s.openCardDetailsModal(s.card))},[S(r,{icon:"circle-info"})])]),e("td",{class:ue({"gained-ap":t(ae)(s.card,t(o).level)>0})},b(s.card.ap+t(ae)(s.card,t(o).level)),3),e("td",null,[y(e("input",{"onUpdate:modelValue":a[1]||(a[1]=d=>t(o).level=d),class:ue(["form-control",{"not-max":t(o).level!==t(A)[s.card.rarity]}]),type:"number",min:"1",max:t(A)[s.card.rarity],onChange:a[2]||(a[2]=d=>L("update:skillLevel",t(o)))},null,42,Je),[[z,t(o).level,void 0,{number:!0}]])]),e("td",null,[y(e("input",{"onUpdate:modelValue":a[3]||(a[3]=d=>t(o).skillLevel=d),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[z,t(o).skillLevel,void 0,{number:!0}]])]),e("td",null,[y(e("input",{"onUpdate:modelValue":a[4]||(a[4]=d=>t(o).centerSkillLevel=d),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[z,t(o).centerSkillLevel,void 0,{number:!0}]])]),e("td",null,[y(e("input",{"onUpdate:modelValue":a[5]||(a[5]=d=>t(o).lbCount=d),class:"form-control",type:"number",min:"0",max:"5"},null,512),[[z,t(o).lbCount,void 0,{number:!0}]])]),e("td",null,[e("div",We,[e("label",Ke,[y(e("input",{"onUpdate:modelValue":a[6]||(a[6]=d=>f(u)?u.value=d:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[F,t(u)]]),a[9]||(a[9]=$(" 必須 ",-1))]),e("label",Qe,[y(e("input",{"onUpdate:modelValue":a[7]||(a[7]=d=>f(u)?u.value=d:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[F,t(u)]]),a[10]||(a[10]=$(" 任意 ",-1))]),e("label",Xe,[y(e("input",{"onUpdate:modelValue":a[8]||(a[8]=d=>f(u)?u.value=d:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[F,t(u)]]),a[11]||(a[11]=$(" 除外 ",-1))])])])])}}}),Ze=Object.assign(Pe(Ye,[["__scopeId","data-v-aa66612b"]]),{__name:"MMemberRow"}),el={class:"card my-2"},ll={class:"card-body"},tl={class:"row"},sl={class:"input-group"},nl={class:"input-group-prepend"},ol={class:"input-group-text",style:{width:"74px","justify-content":"center"}},al=["onUpdate:modelValue"],rl=N({__name:"OSeasonFanLv",props:{seasonFanLvs:{required:!0},seasonFanLvsModifiers:{}},emits:["update:seasonFanLvs"],setup(w){const k=Ae(w,"seasonFanLvs"),g=["kaho","sayaka","rurino","ginko","kosuzu","hime","ceras","izumi"];return(L,_)=>(i(),v("div",el,[_[0]||(_[0]=e("div",{class:"card-header"}," Season Fan Lv. ",-1)),e("div",ll,[e("div",tl,[(i(),v(U,null,M(g,u=>e("div",{key:u,class:"col-12 col-sm-6 col-md-4 col-lg-3 mb-2"},[e("div",sl,[e("div",nl,[e("div",ol,[e("span",null,b(t(Le)[u]),1)])]),y(e("input",{"onUpdate:modelValue":o=>k.value[u]=o,type:"number",class:"form-control",min:"1",max:"10"},null,8,al),[[z,k.value[u],void 0,{number:!0}]])])])),64))])])]))}}),ul=Object.assign(rl,{__name:"OSeasonFanLv"}),il={class:"mb-3"},dl={class:"my-2"},vl={class:"card my-2"},pl={class:"card-body"},cl={class:"table"},ml={class:"card my-2"},fl={class:"card-body"},yl={class:"table"},bl={key:0,rowspan:"14"},kl={class:"card my-2"},gl={class:"card-body"},Cl={class:"table"},Ll={class:"card my-2"},_l={class:"card-body"},$l=N({__name:"MdCardDetails",props:{onClose:{},card:{},displayLevel:{}},setup(w){const k=w,g=R(()=>Array.from({length:14},(o,s)=>_e(Q(k.card,s+1,s+1)))),L=Ne(new Set([...$e[k.card.rarity].map(([o])=>o),k.displayLevel])),_=R(()=>Array.from(L).sort((o,s)=>o-s)),u=R(()=>_.value.map(o=>Q(k.card,1,1,o)));return(o,s)=>{const a=Ue;return i(),ee(a,{"on-close":o.onClose},{default:le(()=>[e("h3",il,b(t(D)(o.card)),1),e("div",dl,[e("div",vl,[s[6]||(s[6]=e("div",{class:"card-header"}," ステータス ",-1)),e("div",pl,[e("table",cl,[e("thead",null,[e("tr",null,[s[1]||(s[1]=e("th",null,"ステータス",-1)),(i(!0),v(U,null,M(t(_),r=>(i(),v("th",{key:`status-${r}`}," Lv."+b(r),1))),128))])]),e("tbody",null,[e("tr",null,[s[2]||(s[2]=e("td",null,"スマイル",-1)),(i(!0),v(U,null,M(t(u),r=>(i(),v("td",{key:`status-smile-${r.key}`},b(r.smile),1))),128))]),e("tr",null,[s[3]||(s[3]=e("td",null,"ピュア",-1)),(i(!0),v(U,null,M(t(u),r=>(i(),v("td",{key:`status-pure-${r.key}`},b(r.pure),1))),128))]),e("tr",null,[s[4]||(s[4]=e("td",null,"クール",-1)),(i(!0),v(U,null,M(t(u),r=>(i(),v("td",{key:`status-cool-${r.key}`},b(r.cool),1))),128))]),e("tr",null,[s[5]||(s[5]=e("td",null,"メンタル",-1)),(i(!0),v(U,null,M(t(u),r=>(i(),v("td",{key:`status-mental-${r.key}`},b(r.mental),1))),128))])])])])]),e("div",ml,[s[8]||(s[8]=e("div",{class:"card-header"}," センタースキル ",-1)),e("div",fl,[e("table",yl,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",null,"スキルLv."),e("th",null,"発動条件"),e("th",null,"効果")])],-1)),e("tbody",null,[(i(!0),v(U,null,M(t(g),(r,d)=>(i(),v("tr",{key:`center-skill-${d}`},[e("td",null,b(d+1),1),d===0?(i(),v("td",bl,b(t(xe)(r.centerSkillCondition)),1)):K("",!0),e("td",null,b(t(re)(r.centerSkills)),1)]))),128))])])])]),e("div",kl,[s[10]||(s[10]=e("div",{class:"card-header"}," スキル ",-1)),e("div",gl,[e("table",Cl,[s[9]||(s[9]=e("thead",null,[e("tr",null,[e("th",null,"スキルLv."),e("th",null,"効果")])],-1)),e("tbody",null,[(i(!0),v(U,null,M(t(g),(r,d)=>(i(),v("tr",{key:`skill-${d}`},[e("td",null,b(d+1),1),e("td",null,b(t(re)(r.skills)),1)]))),128))])])])]),e("div",Ll,[s[11]||(s[11]=e("div",{class:"card-header"}," センター特性 ",-1)),e("div",_l,b(t(we)(t(g)[0].centerAbilities)),1)]),e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=r=>o.onClose(null))}," 閉じる ")])]),_:1},8,["on-close"])}}}),xl=Object.assign($l,{__name:"MdCardDetails"}),wl={class:"container-md"},Ul={class:"card my-2"},Ml={class:"card-body"},Sl={class:"table"},Vl={scope:"col"},Fl={class:"d-flex align-items-end"},Dl={class:""},Ol={class:"input-group"},Tl={class:"input-group-prepend"},zl={class:"input-group-text"},Rl={style:{"min-height":"1.5em"}},hl={class:"card my-2"},Pl={class:"card-body"},Al={class:"mb-2"},Nl={class:"row"},jl={class:"col-auto"},Bl={class:"col-auto"},ql={class:"mb-2"},Gl={class:"row"},Il={class:"col-auto"},El={class:"col-auto"},Hl={class:"mb-2"},Jl={class:"row"},Wl={class:"col-auto"},Kl={class:"col-auto"},Ql={class:"mb-2"},Xl={class:"form-check"},Yl={class:"form-check"},Zl={class:"form-check"},et={class:"form-check"},lt={key:2},tt={class:"card my-2"},st={class:"card-body"},nt=["value"],rt=N({__name:"auto-formation",setup(w){const k=p(""),g=p(""),L=p(0),_=p(0),u=p("smile"),o=p(50),s=p("perfect"),a=p("current"),r=p("score"),d=p([]),j=ie("seasonFanLvs",{kaho:1,sayaka:1,rurino:1,ginko:1,kosuzu:1,hime:1,ceras:1,izumi:1,kozue:1,tsuzuri:1,megumi:1}),B=p(""),q=p(!0),G=p(!0),I=p(!0),E=p(!0),O=p([...Me]),x=p(Object.fromEntries(O.value.map(c=>[C(c),{level:A[c.rarity]||1,centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),ve=(c,l)=>{x.value[c]=l},H=p(null),V=p(null),X=p(0),se=p(Promise.resolve()),T=p("finished"),ne=()=>{H.value=new Worker(new URL(""+new URL("calc-worker-COcxHf6V.js",import.meta.url).href,import.meta.url),{type:"module"}),H.value.onmessage=c=>{switch(c.data.message){case"calcScore":se.value=se.value.then(async()=>{c.data.data.score>(V.value?.score||0)&&(V.value={score:c.data.data.score,liveGrandPrixPt:c.data.data.liveGrandPrixPt,members:c.data.data.members,centerMember:c.data.data.centerMember,log:c.data.data.log})});break;case"progress":X.value=c.data.data.progress;break;case"end":T.value="finished";break}}};te(()=>{ne()});const pe=()=>{V.value=null,X.value=0;const c=Ve(k.value,L.value),l=O.value.filter(m=>x.value[C(m)]&&x.value[C(m)].selected==="required").map(m=>Q(m,x.value[C(m)]?.skillLevel||10,x.value[C(m)]?.centerSkillLevel||10,x.value[C(m)]?.level||1));if(l.length>6){h("必要メンバーが6人を超えています");return}const P=O.value.filter(m=>!x.value[C(m)]?.selected||x.value[C(m)].selected==="optional").map(m=>Q(m,x.value[C(m)]?.skillLevel||10,x.value[C(m)]?.centerSkillLevel||10,x.value[C(m)]?.level||1));T.value="running",H.value?.postMessage(JSON.parse(JSON.stringify({requiredMembers:l,optionalMembers:P,notes:c,center:g.value,attribute:u.value,masteryLevel:o.value,playStyle:s.value,formationRule:a.value,includingCenterOnly:q.value,noLog:G.value,noDamagedFormation:I.value,noCuredFormation:E.value,scoreComparisonRule:r.value,seasonFanLvs:j.value,singers:d.value})))},ce=()=>{H.value?.terminate(),ne(),T.value="finished"},h=c=>{window.alert(c)},{modals:me,openModal:fe}=Se(),ye=async c=>{await fe(xl,{card:c,displayLevel:x.value[C(c)]?.level||1})},Y=p(null),be=()=>{const c=Y.value?.files?.[0];if(c){const l=new FileReader;l.onload=P=>{const m=P.target?.result;O.value=O.value.concat(Fe(m))},l.readAsText(c)}},ke=p(null);return je({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(c,l)=>{const P=De,m=de,ge=Ze,oe=He,Ce=ul;return i(),v("div",wl,[l[48]||(l[48]=e("h1",null,"スクショウ自動編成",-1)),S(P,{"note-text":t(k),"onUpdate:noteText":l[0]||(l[0]=n=>f(k)?k.value=n:null),center:t(g),"onUpdate:center":l[1]||(l[1]=n=>f(g)?g.value=n:null),offset:t(L),"onUpdate:offset":l[2]||(l[2]=n=>f(L)?L.value=n:null),"combo-offset":t(_),"onUpdate:comboOffset":l[3]||(l[3]=n=>f(_)?_.value=n:null),attribute:t(u),"onUpdate:attribute":l[4]||(l[4]=n=>f(u)?u.value=n:null),"mastery-level":t(o),"onUpdate:masteryLevel":l[5]||(l[5]=n=>f(o)?o.value=n:null),singers:t(d),"onUpdate:singers":l[6]||(l[6]=n=>f(d)?d.value=n:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level","singers"]),e("div",Ul,[l[31]||(l[31]=e("div",{class:"card-header"}," メンバー ",-1)),e("div",Ml,[e("table",Sl,[e("thead",null,[e("tr",null,[e("th",Vl,[e("div",Fl,[l[24]||(l[24]=e("div",{style:{"margin-right":"8px"}}," カード ",-1)),e("div",Dl,[e("div",Ol,[e("div",Tl,[e("div",zl,[e("div",Rl,[S(m,{icon:["fas","magnifying-glass"]})])])]),y(e("input",{"onUpdate:modelValue":l[7]||(l[7]=n=>f(B)?B.value=n:null),type:"text",class:"form-control"},null,512),[[z,t(B)]])])])])]),l[25]||(l[25]=e("th",{scope:"col"},"AP",-1)),l[26]||(l[26]=e("th",{scope:"col"},"Lv.",-1)),l[27]||(l[27]=e("th",{scope:"col"},"スキルLv.",-1)),l[28]||(l[28]=e("th",{scope:"col"},"センターSLv.",-1)),l[29]||(l[29]=e("th",{scope:"col"},"凸数",-1)),l[30]||(l[30]=e("th",{scope:"col"},"選択",-1))])]),e("tbody",null,[S(oe,null,{default:le(()=>[(i(!0),v(U,null,M(t(O),n=>y((i(),ee(ge,{key:t(D)(n),card:n,"open-card-details-modal":ye,"onUpdate:skillLevel":Z=>ve(t(C)(n),Z)},null,8,["card","onUpdate:skillLevel"])),[[Be,t(D)(n).toLowerCase().includes(t(B).toLowerCase())]])),128))]),_:1})])]),e("button",{type:"button",class:"btn btn-primary",onClick:l[8]||(l[8]=n=>t(Y)?.click())}," TSVインポート "),e("input",{ref_key:"tsvFileInput",ref:Y,type:"file",class:"d-none",onChange:be},null,544)])]),S(oe,null,{default:le(()=>[S(Ce,{"season-fan-lvs":t(j),"onUpdate:seasonFanLvs":l[9]||(l[9]=n=>f(j)?j.value=n:null)},null,8,["season-fan-lvs"])]),_:1}),e("div",hl,[l[47]||(l[47]=e("div",{class:"card-header"}," 計算 ",-1)),e("div",Pl,[e("div",Al,[l[34]||(l[34]=$(" プレイスタイル： ",-1)),e("div",Nl,[e("div",jl,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[10]||(l[10]=n=>f(s)?s.value=n:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[F,t(s)]]),l[32]||(l[32]=$(" 渾身 ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[11]||(l[11]=n=>h("メンタルを100%以上に保つプレイ"))},[S(m,{icon:"circle-info"})])]),e("div",Bl,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[12]||(l[12]=n=>f(s)?s.value=n:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[F,t(s)]]),l[33]||(l[33]=$(" 背水 ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[13]||(l[13]=n=>h("メンタルを10%以下に保つプレイ"))},[S(m,{icon:"circle-info"})])])])]),e("div",ql,[l[37]||(l[37]=$(" 編成ルール ",-1)),e("div",Gl,[e("div",Il,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[14]||(l[14]=n=>f(a)?a.value=n:null),class:"form-check-input",type:"radio",value:"current"},null,512),[[F,t(a)]]),l[35]||(l[35]=$(" 現状のルール ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[15]||(l[15]=n=>h(`・メンバー1人あたり1種類まで
・カード制限なし`))},[S(m,{icon:"circle-info"})])]),e("div",El,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[16]||(l[16]=n=>f(a)?a.value=n:null),class:"form-check-input",type:"radio",value:"new_grand_prix"},null,512),[[F,t(a)]]),l[36]||(l[36]=$(" 新ライグラルール ",-1))]),e("a",{style:{"vertical-align":"super","font-size":"0.8em"},onClick:l[17]||(l[17]=n=>h(`・メンバー1人あたり2種類まで
・DRは1枚まで`))},[S(m,{icon:"circle-info"})])])])]),e("div",Hl,[l[40]||(l[40]=$(" スコア比較基準 ",-1)),e("div",Jl,[e("div",Wl,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[18]||(l[18]=n=>f(r)?r.value=n:null),class:"form-check-input",type:"radio",value:"score"},null,512),[[F,t(r)]]),l[38]||(l[38]=$(" スコア ",-1))])]),e("div",Kl,[e("label",null,[y(e("input",{"onUpdate:modelValue":l[19]||(l[19]=n=>f(r)?r.value=n:null),class:"form-check-input",type:"radio",value:"grandPrixPt"},null,512),[[F,t(r)]]),l[39]||(l[39]=$(" グランプリpt ",-1))])])])]),e("div",Ql,[l[45]||(l[45]=$(" オプション： ",-1)),e("div",Xl,[y(e("input",{id:"includingCenterOnly","onUpdate:modelValue":l[20]||(l[20]=n=>f(q)?q.value=n:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(q)]]),l[41]||(l[41]=e("label",{class:"form-check-label",for:"includingCenterOnly"}," センターのメンバーを含まない編成は計算しない ",-1))]),e("div",Yl,[y(e("input",{id:"noLog","onUpdate:modelValue":l[21]||(l[21]=n=>f(G)?G.value=n:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(G)]]),l[42]||(l[42]=e("label",{class:"form-check-label",for:"noLog"}," ログを出力しない（効果大） ",-1))]),e("div",Zl,[y(e("input",{id:"noDamagedFormation","onUpdate:modelValue":l[22]||(l[22]=n=>f(I)?I.value=n:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(I)]]),l[43]||(l[43]=e("label",{class:"form-check-label",for:"noDamagedFormation"}," 途中でメンタルが100%未満になった場合計算を打ち切る（渾身選択時以外は自動で無効） ",-1))]),e("div",et,[y(e("input",{id:"noCuredFormation","onUpdate:modelValue":l[23]||(l[23]=n=>f(E)?E.value=n:null),class:"form-check-input",type:"checkbox"},null,512),[[W,t(E)]]),l[44]||(l[44]=e("label",{class:"form-check-label",for:"noCuredFormation"}," 途中でメンタルが10%超になった場合計算を打ち切る（背水選択時以外は自動で無効） ",-1))])]),t(T)!=="running"?(i(),v("button",{key:0,type:"button",class:"btn btn-primary",onClick:pe}," 計算 ")):K("",!0),t(T)==="running"?(i(),v("button",{key:1,type:"button",class:"btn btn-primary",onClick:ce}," 中止 ")):K("",!0),t(V)?(i(),v("div",lt,[e("p",{ref_key:"progressView",ref:ke},b(t(T)==="running"?`計算中... ${t(X).toFixed(2)}%`:"計算完了"),513),e("div",tt,[e("div",st,[e("p",null,"最高得点: "+b(t(V).score)+" ("+b(t(V).liveGrandPrixPt)+"pt)",1),l[46]||(l[46]=e("p",null,"メンバー:",-1)),e("ul",null,[(i(!0),v(U,null,M(t(V).members,n=>(i(),v("li",{key:t(C)(n),style:qe({fontWeight:t(D)(n)===t(D)(t(V).centerMember)?"bold":"normal"})},b(t(D)(n)),5))),128))]),e("textarea",{class:"form-control",value:t(V).log,readonly:"",rows:"5"},null,8,nt)])])])):K("",!0)])]),(i(!0),v(U,null,M(t(me),(n,Z)=>(i(),ee(Ie(n.component),Ge({key:`modal-${Z}`,"on-close":n.onClose},{ref_for:!0},n.args),null,16,["on-close"]))),128))])}}});export{rt as default};
