import{n as v,u as G,o as T,a as M,p as Q,b as E,_ as X}from"./RET_TYWj.js";import{d as P,k as Y,r as a,H as D,o as W,y as k,z as b,A as l,B as O,M as t,J as c,L as B,E as g,S,K as i,x as Z,C as h,N as F,O as H,R,U as K,V as ee,I as le}from"./BE12FkYB.js";const te={class:"row"},oe={class:"col form-check-label"},se={class:"col form-check-label"},ne={class:"col form-check-label"},ae=P({__name:"MMemberRow",props:{card:{}},emits:["update:skillLevel"],setup($,{emit:x}){const U=$,y=x,C=Y(()=>v(U.card)),n=a("optional"),d=G(C,{centerSkillLevel:10,skillLevel:10,selected:"optional"});return D(n,p=>{d.value.selected=p}),D(d,p=>{y("update:skillLevel",p)}),W(()=>{n.value=d.value.selected||"optional",y("update:skillLevel",d.value)}),(p,s)=>(b(),k("tr",null,[l("td",null,O(t(T)(p.card)),1),l("td",null,[c(l("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>t(d).skillLevel=r),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[B,t(d).skillLevel,void 0,{number:!0}]])]),l("td",null,[c(l("input",{"onUpdate:modelValue":s[1]||(s[1]=r=>t(d).centerSkillLevel=r),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[B,t(d).centerSkillLevel,void 0,{number:!0}]])]),l("td",null,[l("div",te,[l("label",oe,[c(l("input",{"onUpdate:modelValue":s[2]||(s[2]=r=>i(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[S,t(n)]]),s[5]||(s[5]=g(" 必須 "))]),l("label",se,[c(l("input",{"onUpdate:modelValue":s[3]||(s[3]=r=>i(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[S,t(n)]]),s[6]||(s[6]=g(" 任意 "))]),l("label",ne,[c(l("input",{"onUpdate:modelValue":s[4]||(s[4]=r=>i(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[S,t(n)]]),s[7]||(s[7]=g(" 除外 "))])])])]))}}),ue=Object.assign(ae,{__name:"MMemberRow"}),re={class:"container-md"},ie={class:"card my-2"},de={class:"card-body"},pe={class:"table"},me={scope:"col"},ve={class:"d-flex align-items-end"},ce={class:""},fe={class:"input-group"},be={class:"card my-2"},ke={class:"card-body"},ye={class:"mb-2"},Le={class:"row"},ge={class:"col-auto"},xe={class:"col-auto"},Ue={class:"mb-2"},we={class:"form-check"},Ce={class:"form-check"},Se={key:2},Ve={class:"card my-2"},_e={class:"card-body"},Me=["value"],Re=P({__name:"auto-formation",setup($){const x=a(""),U=a(""),y=a(0),C=a(0),n=a("smile"),d=a(50),p=a("perfect"),s=a(""),r=a(!0),V=a(!0),f=a(Object.fromEntries(M.map(m=>[v(m),{centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),z=(m,e)=>{f.value[m]=e},_=a(null),L=a(null),j=a(Promise.resolve()),w=a("finished"),q=()=>{_.value=new Worker(new URL(""+new URL("calc-worker-oy4Fi2k-.js",import.meta.url).href,import.meta.url),{type:"module"}),_.value.onmessage=m=>{switch(m.data.message){case"calcScore":j.value=j.value.then(async()=>{m.data.data.score>(L.value?.score||0)&&(L.value={score:m.data.data.score,members:m.data.data.members,log:m.data.data.log})});break;case"end":w.value="finished";break}}};W(()=>{q()});const A=()=>{L.value=null;const m=Q(x.value,y.value),e=M.filter(u=>f.value[v(u)]&&f.value[v(u)].selected==="required").map(u=>E(u,f.value[v(u)]?.skillLevel||10,f.value[v(u)]?.centerSkillLevel||10));if(e.length>6){alert("必要メンバーが6人を超えています");return}const N=M.filter(u=>!f.value[v(u)]?.selected||f.value[v(u)].selected==="optional").map(u=>E(u,f.value[v(u)]?.skillLevel||10,f.value[v(u)]?.centerSkillLevel||10));w.value="running",_.value?.postMessage({requiredMembers:e,optionalMembers:N,notes:m,center:U.value,attribute:n.value,masteryLevel:d.value,playStyle:p.value,includingCenterOnly:r.value,noLog:V.value})},I=()=>{_.value?.terminate(),q(),w.value="finished"};return Z({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(m,e)=>{const N=X,u=ue;return b(),k("div",re,[e[25]||(e[25]=l("h1",null,"スクショウ自動編成",-1)),h(N,{"note-text":t(x),"onUpdate:noteText":e[0]||(e[0]=o=>i(x)?x.value=o:null),center:t(U),"onUpdate:center":e[1]||(e[1]=o=>i(U)?U.value=o:null),offset:t(y),"onUpdate:offset":e[2]||(e[2]=o=>i(y)?y.value=o:null),"combo-offset":t(C),"onUpdate:comboOffset":e[3]||(e[3]=o=>i(C)?C.value=o:null),attribute:t(n),"onUpdate:attribute":e[4]||(e[4]=o=>i(n)?n.value=o:null),"mastery-level":t(d),"onUpdate:masteryLevel":e[5]||(e[5]=o=>i(d)?d.value=o:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level"]),l("div",ie,[e[16]||(e[16]=l("div",{class:"card-header"}," メンバー ",-1)),l("div",de,[l("table",pe,[l("thead",null,[l("tr",null,[l("th",me,[l("div",ve,[e[12]||(e[12]=l("div",{style:{"margin-right":"8px"}}," カード ",-1)),l("div",ce,[l("div",fe,[e[11]||(e[11]=l("div",{class:"input-group-prepend"},[l("span",{class:"input-group-text"},"検索")],-1)),c(l("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>i(s)?s.value=o:null),type:"text",class:"form-control"},null,512),[[B,t(s)]])])])])]),e[13]||(e[13]=l("th",{scope:"col"},"スキルLv.",-1)),e[14]||(e[14]=l("th",{scope:"col"},"センタースキルLv.",-1)),e[15]||(e[15]=l("th",{scope:"col"},"選択",-1))])]),l("tbody",null,[(b(!0),k(F,null,H(t(M),o=>c((b(),le(u,{key:o.key,card:o,"onUpdate:skillLevel":J=>z(t(v)(o),J)},null,8,["card","onUpdate:skillLevel"])),[[ee,t(T)(o).toLowerCase().includes(t(s).toLowerCase())]])),128))])])])]),l("div",be,[e[24]||(e[24]=l("div",{class:"card-header"}," 計算 ",-1)),l("div",ke,[l("div",ye,[e[19]||(e[19]=g(" プレイスタイル： ")),l("div",Le,[l("div",ge,[l("label",null,[c(l("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>i(p)?p.value=o:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[S,t(p)]]),e[17]||(e[17]=g(" 渾身 "))])]),l("div",xe,[l("label",null,[c(l("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>i(p)?p.value=o:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[S,t(p)]]),e[18]||(e[18]=g(" 背水 "))])])])]),l("div",Ue,[e[22]||(e[22]=g(" オプション： ")),l("div",we,[c(l("input",{id:"includingCenterOnly","onUpdate:modelValue":e[9]||(e[9]=o=>i(r)?r.value=o:null),class:"form-check-input",type:"checkbox"},null,512),[[K,t(r)]]),e[20]||(e[20]=l("label",{class:"form-check-label",for:"includingCenterOnly"}," センターのメンバーを含まない編成は計算しない ",-1))]),l("div",Ce,[c(l("input",{id:"noLog","onUpdate:modelValue":e[10]||(e[10]=o=>i(V)?V.value=o:null),class:"form-check-input",type:"checkbox"},null,512),[[K,t(V)]]),e[21]||(e[21]=l("label",{class:"form-check-label",for:"noLog"}," ログを出力しない（効果大） ",-1))])]),t(w)!=="running"?(b(),k("button",{key:0,type:"button",class:"btn btn-primary",onClick:A}," 計算 ")):R("",!0),t(w)==="running"?(b(),k("button",{key:1,type:"button",class:"btn btn-primary",onClick:I}," 中止 ")):R("",!0),t(L)?(b(),k("div",Se,[l("p",null,O(t(w)==="running"?"計算中...":"計算完了"),1),l("div",Ve,[l("div",_e,[l("p",null,"最高得点: "+O(t(L).score),1),e[23]||(e[23]=l("p",null,"メンバー:",-1)),l("ul",null,[(b(!0),k(F,null,H(t(L).members,o=>(b(),k("li",{key:t(v)(o)},O(t(T)(o)),1))),128))]),l("textarea",{class:"form-control",value:t(L).log,readonly:"",rows:"5"},null,8,Me)])])])):R("",!0)])])])}}});export{Re as default};
