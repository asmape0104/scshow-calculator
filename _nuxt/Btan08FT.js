import{n as v,u as I,o as R,a as V,p as J,b as q,_ as X}from"./DEJc6SLZ.js";import{d as D,k as G,r as u,H as E,o as H,y as k,z as f,A as e,B as M,M as t,J as c,L as B,E as g,S as _,K as p,x as Q,C as Y,N as P,O as A,R as N,U as Z,V as h,I as ee}from"./CEKhHntp.js";const le={class:"row"},te={class:"col form-check-label"},se={class:"col form-check-label"},oe={class:"col form-check-label"},ne=D({__name:"MMemberRow",props:{card:{}},emits:["update:skillLevel"],setup(T,{emit:x}){const U=T,y=x,C=G(()=>v(U.card)),n=u("optional"),i=I(C,{centerSkillLevel:10,skillLevel:10,selected:"optional"});return E(n,d=>{i.value.selected=d}),E(i,d=>{y("update:skillLevel",d)}),H(()=>{n.value=i.value.selected||"optional",y("update:skillLevel",i.value)}),(d,o)=>(f(),k("tr",null,[e("td",null,M(t(R)(d.card)),1),e("td",null,[c(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>t(i).skillLevel=r),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[B,t(i).skillLevel,void 0,{number:!0}]])]),e("td",null,[c(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>t(i).centerSkillLevel=r),class:"form-control",type:"number",min:"1",max:"14"},null,512),[[B,t(i).centerSkillLevel,void 0,{number:!0}]])]),e("td",null,[e("div",le,[e("label",te,[c(e("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>p(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"required"},null,512),[[_,t(n)]]),o[5]||(o[5]=g(" 必須 "))]),e("label",se,[c(e("input",{"onUpdate:modelValue":o[3]||(o[3]=r=>p(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"optional"},null,512),[[_,t(n)]]),o[6]||(o[6]=g(" 任意 "))]),e("label",oe,[c(e("input",{"onUpdate:modelValue":o[4]||(o[4]=r=>p(n)?n.value=r:null),class:"form-check-input",type:"radio",value:"excluded"},null,512),[[_,t(n)]]),o[7]||(o[7]=g(" 除外 "))])])])]))}}),ae=Object.assign(ne,{__name:"MMemberRow"}),ue={class:"container-md"},re={class:"card my-2"},ie={class:"card-body"},de={class:"table"},pe={scope:"col"},me={class:"d-flex align-items-end"},ve={class:""},ce={class:"input-group"},be={class:"card my-2"},fe={class:"card-body"},ke={class:"mb-2"},ye={class:"row"},Le={class:"col-auto"},ge={class:"col-auto"},xe={class:"mb-2"},Ue={class:"form-check"},we={key:2},Ce={class:"card my-2"},_e={class:"card-body"},Se=["value"],Oe=D({__name:"auto-formation",setup(T){const x=u(""),U=u(""),y=u(0),C=u(0),n=u("smile"),i=u(50),d=u("perfect"),o=u(""),r=u(!0),b=u(Object.fromEntries(V.map(m=>[v(m),{centerSkillLevel:10,skillLevel:10,selected:"optional"}]))),K=(m,l)=>{b.value[m]=l},S=u(null),L=u(null),$=u(Promise.resolve()),w=u("finished"),j=()=>{S.value=new Worker(new URL(""+new URL("calc-worker-BmUAP3-X.js",import.meta.url).href,import.meta.url),{type:"module"}),S.value.onmessage=m=>{switch(m.data.message){case"calcScore":$.value=$.value.then(async()=>{m.data.data.score>(L.value?.score||0)&&(L.value={score:m.data.data.score,members:m.data.data.members,log:m.data.data.log})});break;case"end":w.value="finished";break}}};H(()=>{j()});const W=()=>{L.value=null;const m=J(x.value,y.value),l=V.filter(a=>b.value[v(a)]&&b.value[v(a)].selected==="required").map(a=>q(a,b.value[v(a)]?.skillLevel||10,b.value[v(a)]?.centerSkillLevel||10));if(l.length>6){alert("必要メンバーが6人を超えています");return}const O=V.filter(a=>!b.value[v(a)]?.selected||b.value[v(a)].selected==="optional").map(a=>q(a,b.value[v(a)]?.skillLevel||10,b.value[v(a)]?.centerSkillLevel||10));w.value="running",S.value?.postMessage({requiredMembers:l,optionalMembers:O,notes:m,center:U.value,attribute:n.value,masteryLevel:i.value,playStyle:d.value,includingCenterOnly:r.value})},z=()=>{S.value?.terminate(),j(),w.value="finished"};return Q({title:"スクショウ自動編成",meta:[{name:"twitter:title",content:"スクショウ自動編成"}]}),(m,l)=>{const O=X,a=ae;return f(),k("div",ue,[l[23]||(l[23]=e("h1",null,"スクショウ自動編成",-1)),Y(O,{"note-text":t(x),"onUpdate:noteText":l[0]||(l[0]=s=>p(x)?x.value=s:null),center:t(U),"onUpdate:center":l[1]||(l[1]=s=>p(U)?U.value=s:null),offset:t(y),"onUpdate:offset":l[2]||(l[2]=s=>p(y)?y.value=s:null),"combo-offset":t(C),"onUpdate:comboOffset":l[3]||(l[3]=s=>p(C)?C.value=s:null),attribute:t(n),"onUpdate:attribute":l[4]||(l[4]=s=>p(n)?n.value=s:null),"mastery-level":t(i),"onUpdate:masteryLevel":l[5]||(l[5]=s=>p(i)?i.value=s:null)},null,8,["note-text","center","offset","combo-offset","attribute","mastery-level"]),e("div",re,[l[15]||(l[15]=e("div",{class:"card-header"}," メンバー ",-1)),e("div",ie,[e("table",de,[e("thead",null,[e("tr",null,[e("th",pe,[e("div",me,[l[11]||(l[11]=e("div",{style:{"margin-right":"8px"}}," カード ",-1)),e("div",ve,[e("div",ce,[l[10]||(l[10]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"検索")],-1)),c(e("input",{"onUpdate:modelValue":l[6]||(l[6]=s=>p(o)?o.value=s:null),type:"text",class:"form-control"},null,512),[[B,t(o)]])])])])]),l[12]||(l[12]=e("th",{scope:"col"},"スキルLv.",-1)),l[13]||(l[13]=e("th",{scope:"col"},"センタースキルLv.",-1)),l[14]||(l[14]=e("th",{scope:"col"},"選択",-1))])]),e("tbody",null,[(f(!0),k(P,null,A(t(V),s=>c((f(),ee(a,{key:s.key,card:s,"onUpdate:skillLevel":F=>K(t(v)(s),F)},null,8,["card","onUpdate:skillLevel"])),[[h,t(R)(s).toLowerCase().includes(t(o).toLowerCase())]])),128))])])])]),e("div",be,[l[22]||(l[22]=e("div",{class:"card-header"}," 計算 ",-1)),e("div",fe,[e("div",ke,[l[18]||(l[18]=g(" プレイスタイル： ")),e("div",ye,[e("div",Le,[e("label",null,[c(e("input",{"onUpdate:modelValue":l[7]||(l[7]=s=>p(d)?d.value=s:null),class:"form-check-input",type:"radio",value:"perfect"},null,512),[[_,t(d)]]),l[16]||(l[16]=g(" 渾身 "))])]),e("div",ge,[e("label",null,[c(e("input",{"onUpdate:modelValue":l[8]||(l[8]=s=>p(d)?d.value=s:null),class:"form-check-input",type:"radio",value:"desperate"},null,512),[[_,t(d)]]),l[17]||(l[17]=g(" 背水 "))])])])]),e("div",xe,[l[20]||(l[20]=g(" オプション： ")),e("div",Ue,[c(e("input",{id:"includingCenterOnly","onUpdate:modelValue":l[9]||(l[9]=s=>p(r)?r.value=s:null),class:"form-check-input",type:"checkbox"},null,512),[[Z,t(r)]]),l[19]||(l[19]=e("label",{class:"form-check-label",for:"includingCenterOnly"}," センターのメンバーを含まない編成は計算しない ",-1))])]),t(w)!=="running"?(f(),k("button",{key:0,type:"button",class:"btn btn-primary",onClick:W}," 計算 ")):N("",!0),t(w)==="running"?(f(),k("button",{key:1,type:"button",class:"btn btn-primary",onClick:z}," 中止 ")):N("",!0),t(L)?(f(),k("div",we,[e("p",null,M(t(w)==="running"?"計算中...":"計算完了"),1),e("div",Ce,[e("div",_e,[e("p",null,"最高得点: "+M(t(L).score),1),l[21]||(l[21]=e("p",null,"メンバー:",-1)),e("ul",null,[(f(!0),k(P,null,A(t(L).members,s=>(f(),k("li",{key:t(v)(s)},M(t(R)(s)),1))),128))]),e("textarea",{class:"form-control",value:t(L).log,readonly:"",rows:"5"},null,8,Se)])])])):N("",!0)])])])}}});export{Oe as default};
